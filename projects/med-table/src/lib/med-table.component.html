<div #upScrollRef class="med-table__up-scroll">
  <div #upScrollItemRef class="med-table__up-scroll-item"></div>
</div>

<p-table
  #tableRef
  class="med-table"
  [value]="data"
  [columns]="config"
  [loading]="loading"
  [rows]="localSettings.rows"
  [globalFilterFields]="filterableFields"
  [paginator]="localSettings.paginator"
  [filterDelay]="localSettings.filterDelay"
  [scrollHeight]="localSettings.scrollHeight"
  [rowsPerPageOptions]="localSettings.rowsPerPageOptions"
  [showCurrentPageReport]="localSettings.showCurrentPageReport"
  [currentPageReportTemplate]="localSettings.currentPageReportTemplate"
>
  <ng-template pTemplate="caption">
    <span class="p-input-icon-left p-ml-auto">
      <i class="pi pi-search"></i>
      <input
        pInputText
        type="text"
        placeholder="Search keyword"
        (input)="tableRef.filterGlobal($any($event.target).value, 'contains')"
      />
    </span>

    <ng-container *ngTemplateOutlet="captionTemplate || null"></ng-container>
  </ng-template>

  <ng-template pTemplate="header">
    <tr>
      <th *ngFor="let col of config" class="med-table__header">
        <span>{{ col.label }}</span>
        <p-sortIcon [field]="col.key"></p-sortIcon>
      </th>
    </tr>

    <tr *ngIf="filterableFields.length">
      <th *ngFor="let col of config">
        <div
          *ngIf="col.filterable"
          [style.minWidth]="col.minWidth || localSettings.colMinWidth"
        >
          <p-columnFilter
            type="text"
            matchMode="contains"
            [field]="col.key"
            [showMenu]="false"
            [showClearButton]="false"
          ></p-columnFilter>
        </div>
      </th>
    </tr>
  </ng-template>

  <ng-template pTemplate="body" let-item>
    <tr class="med-table__row">
      <td *ngFor="let column of config" class="med-table__td">
        <table-data
          [config]="column"
          [item]="item"
          [template]="tdTemplate"
          (update)="updateColumn.emit($event)"
        ></table-data>

        <ng-template #tdTemplate let-data let-item="item">
          <ng-container *ngTemplateOutlet="
            tableDataTemplate || null
            context: { $implicit: data, item: item, config: column }"
          ></ng-container>
        </ng-template>
      </td>
    </tr>
  </ng-template>

  <ng-template pTemplate="emptymessage">
    <tr>
      <td [attr.colspan]="config.length">{{ localSettings.emptyMessage }}</td>
    </tr>
  </ng-template>
</p-table>
