<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>MedTableApp</title>
  <base href="/">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">

</head>
<body>
  <app-med-table config=""></app-med-table>

  <script>
    const appRoot = document.querySelector('app-med-table');

    const CONFIG = {
      tableColumns: [
        {
          key: 'mnn.id',
          label: 'mnn_id',
          filterable: true,
          minWidth: '5rem',
        },
        {
          key: 'mnn.type',
          label: 'Напрям',
          filterable: true,
        },
        {
          key: 'mnn.subtype',
          label: 'Піднапрям',
          filterable: true,
        },
        {
          key: 'mnn.name',
          label: 'МНН',
          filterable: true,
        },
        {
          key: 'mnn.release_form',
          label: 'Форма випуску',
          filterable: true,
        },
        {
          key: 'mnn.dosage',
          label: 'Дозування',
          filterable: true,
        },
        {
          key: 'cpv_code',
          label: 'CPV-код',
          filterable: true,
          editorType: "select",
          minWidth: '10rem',
        },
        {
          key: 'responsible',
          sortKey: 'responsible.name',
          label: 'Відповідальний менеджер',
          filterable: true,
          editorType: "select",
        },
        {
          key: 's20',
          label: 'Доведена кількість МОЗ',
          filterable: true,
          editorType: "number",
          defaultValue: '0',
        },
        {
          key: 'tender_quantity',
          label: 'Кількість закупівлі',
          filterable: true,
          editorType: "number",
          defaultValue: '0',
        },
        {
          key: 'publisher',
          sortKey: 'publisher.name',
          label: 'Відповідальна особа за підписання',
          filterable: true,
          editorType: "select",
        },
        {
          key: 'agreement_value',
          label: 'Сума позиції за договором',
          filterable: true,
          editorType: "text",
          decimal: true,
        },
        {
          key: 'agreement_num',
          label: 'Номер договору',
          filterable: true,
          editorType: "text",
        },
        {
          key: 'agreement_fact_date',
          label: 'Дата підписання договору',
          filterable: true,
          editorType: "date",
        },
        {
          key: 'agreement_final_date',
          label: 'Кінцева дата дії договору',
          filterable: true,
          editorType: "date",
        },
        {
          key: 'delivery_date',
          label: 'Строк поставки',
          filterable: true,
          editorType: "date",
        },
        {
          key: 'winner',
          label: 'Переможець',
          filterable: true,
          editorType: "text",
        },
        {
          key: 'winner_edrpou',
          label: 'ЄДРПОУ переможця',
          filterable: true,
          editorType: "text",
        },
        {
          key: 'manufacturer',
          label: 'Виробник',
          filterable: true,
          editorType: "text",
        },
        {
          key: 'manufacturer_country',
          label: 'Країна виробника',
          filterable: true,
          editorType: "text",
        },
        {
          key: 'trade_name',
          label: 'Торгова назва',
          filterable: true,
          editorType: "text",
        },
        {
          key: 'tender_id',
          label: 'Посилання на Prozorro',
          filterable: true,
          editorType: "text",
        },
        {
          key: 'api_id',
          label: 'API Prozorro',
          filterable: true,
          editorType: "text",
        },
        {
          key: 'quantity',
          label: 'Кількість закупівлі (Додаткова угода)',
          filterable: true,
          editorType: "number",
        },
        {
          key: 'proc_sum',
          label: 'Сума позиції (Додаткова угода)',
          filterable: true,
          editorType: "text",
          decimal: true,
        },
        {
          key: 'agreement_final_date',
          label: 'Кінцева дата дії договору (Додаткова угода)',
          filterable: true,
          editorType: "date",
        },
      ],
      formFields: [
        {
          key: 'cpv_code',
          label: 'CPV-код',
          editorType: "select",
          class: 'field col-12 md:col-6',
        },
        {
          key: 'responsible',
          label: 'Відповідальний менеджер',
          editorType: "select",
          class: 'field col-12 md:col-6',
        },
        {
          key: 's20',
          label: 'Доведена кількість МОЗ',
          editorType: "number",
          class: 'field col-12 md:col-6',
          required: true,
        },
        {
          key: 'tender_quantity',
          label: 'Кількість закупівлі',
          editorType: "number",
          class: 'field col-12 md:col-6',
          required: true,
        },
        {
          key: 'publisher',
          label: 'Відповідальна особа за підписання',
          editorType: "select",
          class: 'field col-12 md:col-6',
        },
        {
          key: 'agreement_value',
          label: 'Сума позиції за договором',
          editorType: "text",
          decimal: true,
          class: 'field col-12 md:col-6',
        },
        {
          key: 'agreement_num',
          label: 'Номер договору',
          editorType: "text",
          class: 'field col-12 md:col-6',
        },
        {
          key: 'agreement_fact_date',
          label: 'Дата підписання договору',
          editorType: "date",
          class: 'field col-12 md:col-6',
        },
        {
          key: 'agreement_final_date',
          label: 'Кінцева дата дії договору',
          editorType: "date",
          class: 'field col-12 md:col-6',
        },
        {
          key: 'delivery_date',
          label: 'Строк поставки',
          editorType: "date",
          class: 'field col-12 md:col-6',
        },
        {
          key: 'winner',
          label: 'Переможець',
          editorType: "text",
          class: 'field col-12 md:col-6',
        },
        {
          key: 'winner_edrpou',
          label: 'ЄДРПОУ переможця',
          editorType: "text",
          class: 'field col-12 md:col-6',
        },
        {
          key: 'manufacturer',
          label: 'Виробник',
          editorType: "text",
          class: 'field col-12 md:col-6',
        },
        {
          key: 'manufacturer_country',
          label: 'Країна виробника',
          editorType: "text",
          class: 'field col-12 md:col-6',
        },
        {
          key: 'trade_name',
          label: 'Торгова назва',
          editorType: "text",
          class: 'field col-12 md:col-6',
        },
        {
          key: 'tender_id',
          label: 'Посилання на Prozorro',
          editorType: "text",
          class: 'field col-12 md:col-6',
        },
        {
          key: 'api_id',
          label: 'API Prozorro',
          editorType: "text",
          class: 'field col-12 md:col-6',
        },
        {
          key: 'quantity',
          label: 'Кількість закупівлі (Додаткова угода)',
          editorType: "number",
          class: 'field col-12 md:col-6',
        },
        {
          key: 'proc_sum',
          label: 'Сума позиції (Додаткова угода)',
          editorType: "text",
          decimal: true,
          class: 'field col-12 md:col-6',
        },
        {
          key: 'agreement_final_date',
          label: 'Кінцева дата дії договору (Додаткова угода)',
          editorType: "date",
          class: 'field col-12 md:col-6',
        },
      ],
      settings: {
        export: true,
        sticky: false,
      },
      urls: {
        getData: 'https://meddata.com.ua/index.php?method=Procurements&function=purchaseForm&option=com_fabrik&format=raw&task=plugin.userAjax&dev=1',
        update: 'https://meddata.com.ua/index.php?method=Procurements&function=savePurchaseForm&option=com_fabrik&format=raw&task=plugin.userAjax&dev=1',
        add: 'https://meddata.com.ua/index.php?method=Procurements&function=savePurchaseForm&option=com_fabrik&format=raw&task=plugin.userAjax&dev=1',
        selectData: '',
      },
    };

    const CONFIG2 = {
      tableColumns: [
        {
          key: 'item_id',
          label: '№',
          filterable: true,
          minWidth: '5rem',
        },
        {
          key: 'name',
          label: 'Находження на ДОЗ',
          filterable: true,
          cellType: 'link',
          linkOptions: {
            url: 'http://localhost:4200',
            keyParam: 'id',
            target: '_blank',
          },
        },
        {
          key: 'delivered',
          label: 'Дата надходження',
          filterable: true,
          filterType: 'date',
        },
        {
          editorType: 'text',
          key: 'status.name',
          label: 'Поточний статус',
          filterable: true,
          minWidth: '18rem',
          filterType: 'select',
        },
        {
          key: 'updated',
          label: 'Дата остінньої зміни статусу',
          filterable: true,
          filterType: 'date',
        },
        {
          key: 'location',
          label: 'Поточне місцезнаходження',
          filterable: true,
        },
        {
          key: 'sender',
          label: 'Відправник',
          filterable: true,
        },
        {
          key: 'transport',
          sortKey: 'transport.name',
          label: 'Транспорт',
          filterable: true,
        },
        {
          key: 'driver',
          sortKey: 'driver.name',
          label: 'Водій',
          filterable: true,
        },
      ],
      settings: {
        export: true,
      },
      urls: {
        getData: 'https://meddata.com.ua/index.php?option=com_fabrik&format=raw&task=plugin.userAjax&method=Humanitarian&function=getDozSupply&supply=1&dev=1',
      },
    };

    const CONFIG3 = {
      tableColumns: [
        {
          key: 'division',
          label: 'ЗОЗ-отримувачі',
          filterable: true,
          minWidth: '25rem',
        },
        {
          key: 'need',
          label: 'Середньомісячна потреба',
          filterable: true,
        },
        {
          key: 'recommended_quantity',
          label: 'Рекомендована кількість розподілу',
          filterable: true,
        },
        {
          key: 'distribution_quantity',
          label: 'Обсяг розподілу',
          filterable: true,
          editorType: 'number',
        },
        {
          key: 'comment',
          label: 'Коментар',
          filterable: true,
        },
      ],
      urls: {
        getData: 'https://meddata.com.ua/index.php?option=com_fabrik&format=raw&task=plugin.userAjax&method=Humanitarian&function=getZozDistribution&dev=1',
      },
    };

    appRoot.setAttribute('config', JSON.stringify({
      tableColumns: [
        {
          key: 'name',
          label: 'Назва',
          filterable: true,
        },
        {
          key: 'dosage',
          label: 'одиниця',
          filterable: true,
        },
        {
          key: 'quantity',
          label: 'Кількість поставки',
          filterable: true,
        },
        {
          key: 'delivery_balance',
          label: 'Залишок поставки',
          filterable: true,
          defaultValue: 0,
          cellType: 'link',
          linkOptions: {
            url: 'http://localhost:4200',
            keyParam: 'item_id',
            target: '_blank',
          },
        },
      ],
      urls: {
        getData: 'https://meddata.com.ua/index.php?option=com_fabrik&format=raw&task=plugin.userAjax&method=Humanitarian&function=getSupplyDistribution&dev=1',
      },
    }));
  </script>
</body>
</html>
